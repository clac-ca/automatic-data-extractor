# ==============================================================================
# .env.example - ADE
#
# This project uses:
# - Postgres for the database
# - Azure Blob Storage for file storage
#
# Local development uses:
# - Postgres (docker-compose)
# - Azurite (Azure Blob emulator) via connection string auth
#
# Production uses:
# - Postgres
# - Azure Blob via Managed Identity (recommended) or connection string
#
# How to use:
# 1) Copy this file to .env
# 2) Pick ONE profile below (Local Dev or Production) and uncomment it
# 3) Leave the rest commented unless you need advanced overrides
#
# Tips:
# - Booleans accept true/false/1/0 (case-insensitive).
# - Sizes are bytes unless noted (e.g., 4194304 = 4 MiB).
# - Lists can be JSON arrays or comma-separated (e.g., ADE_SERVER_CORS_ORIGINS).
# - ADE_DATABASE_URL and ADE_STORAGE_BACKEND are required in all environments.
# ==============================================================================

# ------------------------------------------------------------------------------
# Local Dev (devcontainer / docker-compose): Postgres + Azurite
# ------------------------------------------------------------------------------
# ADE_APP_ENVIRONMENT=local
#
# Postgres (inside docker-compose network)
# ADE_DATABASE_URL=postgresql+psycopg://ade:ade@postgres:5432/ade?sslmode=disable
# ADE_DATABASE_AUTH_MODE=password
#
# Blob storage (Azurite - connection string auth only)
# ADE_STORAGE_BACKEND=azure_blob
# ADE_BLOB_CONNECTION_STRING=DefaultEndpointsProtocol=http;AccountName=devstoreaccount1;AccountKey=<dev-key>;BlobEndpoint=http://azurite:10000/devstoreaccount1;
# ADE_BLOB_CONTAINER=ade
# ADE_BLOB_PREFIX=workspaces
# ADE_BLOB_REQUIRE_VERSIONING=false
# ADE_BLOB_CREATE_CONTAINER_ON_STARTUP=true


# ------------------------------------------------------------------------------
# Production: Postgres + Azure Blob
# ------------------------------------------------------------------------------
# ADE_APP_ENVIRONMENT=prod
#
# Postgres (example)
# ADE_DATABASE_URL=postgresql+psycopg://<user>:<password>@<host>:5432/<db>?sslmode=require
# ADE_DATABASE_AUTH_MODE=password
# ADE_DATABASE_SSLROOTCERT=/path/to/ca.crt
#
# Blob storage (Azure)
# ADE_STORAGE_BACKEND=azure_blob
# ADE_BLOB_CONTAINER=ade
# ADE_BLOB_PREFIX=workspaces
# ADE_BLOB_REQUIRE_VERSIONING=true
#
# Choose ONE auth option:
#
# 1) Managed Identity / AAD (recommended)
# ADE_BLOB_ACCOUNT_URL=https://<account>.blob.core.windows.net
# AZURE_CLIENT_ID=   # optional: user-assigned managed identity client id
#
# 2) Connection string (shared key or Azurite-style)
# ADE_BLOB_CONNECTION_STRING=DefaultEndpointsProtocol=https;AccountName=<account>;AccountKey=<key>;EndpointSuffix=core.windows.net


# ==============================================================================
# Everything below is optional. Uncomment to override defaults.
# Durations accept plain seconds or suffixes like 30s/5m/2h/14d.
# ==============================================================================

# ---- Core ----
# ADE_APP_NAME=Automatic Data Extractor API
# ADE_APP_VERSION=1.6.1
# ADE_APP_ENVIRONMENT=unknown
# ADE_APP_COMMIT_SHA=unknown
# ADE_API_DOCS_ENABLED=false
# ADE_DOCS_URL=/docs
# ADE_REDOC_URL=/redoc
# ADE_OPENAPI_URL=/openapi.json
# ADE_LOG_LEVEL=INFO
# ADE_SAFE_MODE=false

# ---- Server ----
# Public URL used for links/redirects and CORS defaults.
# ADE_SERVER_PUBLIC_URL=http://localhost:8000
# ADE_API_HOST=
# ADE_API_PORT=
# ADE_API_WORKERS=
# ADE_FRONTEND_URL=http://localhost:8000
# ADE_FRONTEND_DIST_DIR=
# ADE_SERVER_CORS_ORIGINS=["http://localhost:5173"]
# ADE_IDEMPOTENCY_KEY_TTL=24h

# ---- Paths ----
# ADE_API_ROOT=apps/ade-api
# ADE_ALEMBIC_INI_PATH=apps/ade-api/alembic.ini
# ADE_ALEMBIC_MIGRATIONS_DIR=apps/ade-api/migrations
# ADE_DATA_DIR=data

# ---- Storage ----
# filesystem backend stores files under ADE_DATA_DIR
# ADE_STORAGE_BACKEND=filesystem
# ADE_STORAGE_UPLOAD_MAX_BYTES=26214400
# ADE_STORAGE_DOCUMENT_RETENTION_PERIOD=30d
# ADE_DOCUMENTS_UPLOAD_CONCURRENCY_LIMIT=8

# ---- Azure Blob (auth via managed identity or connection string) ----
# ADE_STORAGE_BACKEND=azure_blob
# Auth matrix:
# - managed_identity: ADE_BLOB_ACCOUNT_URL (+ optional AZURE_CLIENT_ID)
# - connection_string: ADE_BLOB_CONNECTION_STRING
# Option A: AAD auth (Managed Identity / az login)
# ADE_BLOB_ACCOUNT_URL=https://<account>.blob.core.windows.net
# Option B: Connection string (Azurite/dev or key-based access)
# ADE_BLOB_CONNECTION_STRING=DefaultEndpointsProtocol=http;AccountName=devstoreaccount1;AccountKey=...;BlobEndpoint=http://azurite:10000/devstoreaccount1;
# ADE_BLOB_CONTAINER=ade
# ADE_BLOB_PREFIX=workspaces
# ADE_BLOB_REQUIRE_VERSIONING=true   # set false for Azurite
# ADE_BLOB_CREATE_CONTAINER_ON_STARTUP=false
# ADE_BLOB_REQUEST_TIMEOUT_SECONDS=30
# ADE_BLOB_MAX_CONCURRENCY=4
# ADE_BLOB_UPLOAD_CHUNK_SIZE_BYTES=4194304
# ADE_BLOB_DOWNLOAD_CHUNK_SIZE_BYTES=1048576

# ---- Engine ----
# ADE_ENGINE_SPEC="ade-engine @ git+https://github.com/clac-ca/ade-engine@main"
# ADE_ENGINE_PACKAGE_PATH="ade-engine @ git+https://github.com/clac-ca/ade-engine@main"

# ---- Database (Postgres) ----
# Managed identity uses Entra token auth; password is ignored in that mode.
# ADE_DATABASE_URL=postgresql+psycopg://ade:ade@postgres:5432/ade?sslmode=disable
# ADE_DATABASE_ECHO=false
# ADE_DATABASE_LOG_LEVEL=
# ADE_DATABASE_POOL_SIZE=5
# ADE_DATABASE_MAX_OVERFLOW=10
# ADE_DATABASE_POOL_TIMEOUT=30
# ADE_DATABASE_POOL_RECYCLE=1800
# ADE_DATABASE_AUTH_MODE=password
# ADE_DATABASE_SSLROOTCERT=

# ---- JWT ----
# Set a real secret in production (>= 32 chars). If unset, a random one is generated at startup.
# ADE_JWT_SECRET=
# ADE_JWT_ALGORITHM=HS256
# ADE_JWT_ACCESS_TTL=1h

# ---- Sessions ----
# ADE_SESSION_COOKIE_NAME=ade_session
# ADE_SESSION_CSRF_COOKIE_NAME=ade_csrf
# ADE_SESSION_COOKIE_DOMAIN=
# ADE_SESSION_COOKIE_PATH=/
# ADE_SESSION_ACCESS_TTL=14d

# ---- Auth policy ----
# ADE_API_KEY_PREFIX_LENGTH=12
# ADE_API_KEY_SECRET_BYTES=32
# ADE_FAILED_LOGIN_LOCK_THRESHOLD=5
# ADE_FAILED_LOGIN_LOCK_DURATION=5m
# ADE_ALLOW_PUBLIC_REGISTRATION=false
# ADE_AUTH_DISABLED=false
# ADE_AUTH_DISABLED_USER_EMAIL=developer@example.com
# ADE_AUTH_DISABLED_USER_NAME=Development User
# ADE_AUTH_FORCE_SSO=false
# ADE_AUTH_SSO_AUTO_PROVISION=false
# ADE_AUTH_SSO_PROVIDERS_JSON=
# ADE_SSO_ENCRYPTION_KEY=

# ---- Runs ----
# ADE_PREVIEW_TIMEOUT_SECONDS=10

# ---- Web (dev server) ----
# ADE_WEB_HOST=0.0.0.0
# ADE_WEB_PORT=5173
