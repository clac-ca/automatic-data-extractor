{
  "schema_version": 1,
  "scope": "run",
  "execution": {
    "status": "failed",
    "started_at": "2025-12-16T20:05:11Z",
    "completed_at": "2025-12-16T20:05:19Z",
    "duration_ms": 8123,
    "failure": {
      "stage": "render",
      "code": "output_write_failed",
      "message": "Failed to write normalized workbook output (permission denied)."
    }
  },
  "evaluation": {
    "outcome": "partial",
    "findings": [
      {
        "code": "execution_failed",
        "severity": "error",
        "message": "Run failed before completion; summary reflects partial progress."
      },
      {
        "code": "output_write_failed",
        "severity": "error",
        "message": "Normalized output workbook was not written; outputs pointers are omitted.",
        "meta": {
          "attempted_output_path": "outputs/2025-12-16/run_9f3c6f9c/output.xlsx"
        }
      },
      {
        "code": "fields_unmapped",
        "severity": "warning",
        "message": "One or more expected fields were not mapped in any detected table.",
        "count": 2,
        "meta": {
          "unmapped_fields": [
            "vendor_name",
            "currency"
          ]
        }
      },
      {
        "code": "validation_warnings_present",
        "severity": "warning",
        "message": "Validation produced warnings that may impact downstream consumers.",
        "count": 1,
        "meta": {
          "max_severity": "warning"
        }
      },
      {
        "code": "partial_progress_preserved",
        "severity": "info",
        "message": "At least one table was summarized before failure."
      }
    ]
  },
  "counts": {
    "workbooks": 1,
    "sheets": 1,
    "tables": 1,
    "rows": {
      "total": 120,
      "empty": 5
    },
    "columns": {
      "total": 5,
      "empty": 0,
      "mapped": 3,
      "ambiguous": 1,
      "unmapped": 0,
      "passthrough": 1
    },
    "fields": {
      "expected": 5,
      "mapped": 3
    },
    "cells": {
      "total": 600,
      "non_empty": 524
    }
  },
  "validation": {
    "rows_evaluated": 115,
    "issues_total": 1,
    "issues_by_severity": {
      "warning": 1
    },
    "max_severity": "warning"
  },
  "fields": [
    {
      "field": "invoice_number",
      "label": "Invoice Number",
      "mapped": true,
      "best_mapping_score": 0.98,
      "occurrences": {
        "tables": 1,
        "columns": 1
      }
    },
    {
      "field": "invoice_date",
      "label": "Invoice Date",
      "mapped": true,
      "best_mapping_score": 0.95,
      "occurrences": {
        "tables": 1,
        "columns": 1
      }
    },
    {
      "field": "vendor_name",
      "label": "Vendor Name",
      "mapped": false,
      "occurrences": {
        "tables": 0,
        "columns": 0
      }
    },
    {
      "field": "total_amount",
      "label": "Total Amount",
      "mapped": true,
      "best_mapping_score": 0.93,
      "occurrences": {
        "tables": 1,
        "columns": 1
      }
    },
    {
      "field": "currency",
      "label": "Currency",
      "mapped": false,
      "occurrences": {
        "tables": 0,
        "columns": 0
      }
    }
  ],
  "workbooks": [
    {
      "scope": "workbook",
      "locator": {
        "workbook": {
          "index": 0,
          "name": "Acme AP - Nov 2025.xlsx"
        }
      },
      "counts": {
        "sheets": 1,
        "tables": 1,
        "rows": {
          "total": 120,
          "empty": 5
        },
        "columns": {
          "total": 5,
          "empty": 0,
          "mapped": 3,
          "ambiguous": 1,
          "unmapped": 0,
          "passthrough": 1
        },
        "fields": {
          "expected": 5,
          "mapped": 3
        },
        "cells": {
          "total": 600,
          "non_empty": 524
        }
      },
      "validation": {
        "rows_evaluated": 115,
        "issues_total": 1,
        "issues_by_severity": {
          "warning": 1
        },
        "max_severity": "warning"
      },
      "sheets": [
        {
          "scope": "sheet",
          "locator": {
            "workbook": {
              "index": 0,
              "name": "Acme AP - Nov 2025.xlsx"
            },
            "sheet": {
              "index": 0,
              "name": "Invoices"
            }
          },
          "counts": {
            "tables": 1,
            "rows": {
              "total": 120,
              "empty": 5
            },
            "columns": {
              "total": 5,
              "empty": 0,
              "mapped": 3,
              "ambiguous": 1,
              "unmapped": 0,
              "passthrough": 1
            },
            "fields": {
              "expected": 5,
              "mapped": 3
            },
            "cells": {
              "total": 600,
              "non_empty": 524
            }
          },
          "validation": {
            "rows_evaluated": 115,
            "issues_total": 1,
            "issues_by_severity": {
              "warning": 1
            },
            "max_severity": "warning"
          },
          "scan": {
            "rows_emitted": 140,
            "stopped_early": true,
            "truncated_rows": 320
          },
          "tables": [
            {
              "scope": "table",
              "locator": {
                "workbook": {
                  "index": 0,
                  "name": "Acme AP - Nov 2025.xlsx"
                },
                "sheet": {
                  "index": 0,
                  "name": "Invoices"
                },
                "table": {
                  "index": 0
                }
              },
              "counts": {
                "rows": {
                  "total": 120,
                  "empty": 5
                },
                "columns": {
                  "total": 5,
                  "empty": 0,
                  "mapped": 3,
                  "ambiguous": 1,
                  "unmapped": 0,
                  "passthrough": 1
                },
                "fields": {
                  "expected": 5,
                  "mapped": 3
                },
                "cells": {
                  "total": 600,
                  "non_empty": 524
                }
              },
              "validation": {
                "rows_evaluated": 115,
                "issues_total": 1,
                "issues_by_severity": {
                  "warning": 1
                },
                "max_severity": "warning"
              },
              "structure": {
                "region": {
                  "a1": "Invoices!A1:E121"
                },
                "header": {
                  "row_start": 1,
                  "row_count": 1,
                  "inferred": false
                },
                "data": {
                  "row_start": 2,
                  "row_count": 120
                },
                "columns": [
                  {
                    "index": 0,
                    "header": {
                      "raw": "Invoice #",
                      "normalized": "invoice_number"
                    },
                    "non_empty_cells": 120,
                    "mapping": {
                      "status": "mapped",
                      "field": "invoice_number",
                      "score": 0.98,
                      "method": "classifier",
                      "candidates": [
                        {
                          "field": "invoice_number",
                          "score": 0.98
                        },
                        {
                          "field": "vendor_name",
                          "score": 0.12
                        },
                        {
                          "field": "invoice_date",
                          "score": 0.07
                        }
                      ]
                    }
                  },
                  {
                    "index": 1,
                    "header": {
                      "raw": "Date",
                      "normalized": "invoice_date"
                    },
                    "non_empty_cells": 120,
                    "mapping": {
                      "status": "mapped",
                      "field": "invoice_date",
                      "score": 0.95,
                      "method": "classifier",
                      "candidates": [
                        {
                          "field": "invoice_date",
                          "score": 0.95
                        },
                        {
                          "field": "invoice_number",
                          "score": 0.1
                        },
                        {
                          "field": "total_amount",
                          "score": 0.05
                        }
                      ]
                    }
                  },
                  {
                    "index": 2,
                    "header": {
                      "raw": "Vendor",
                      "normalized": "vendor"
                    },
                    "non_empty_cells": 120,
                    "mapping": {
                      "status": "ambiguous",
                      "candidates": [
                        {
                          "field": "vendor_name",
                          "score": 0.62
                        },
                        {
                          "field": "invoice_number",
                          "score": 0.58
                        },
                        {
                          "field": "currency",
                          "score": 0.41
                        }
                      ],
                      "unmapped_reason": "ambiguous_top_candidates"
                    }
                  },
                  {
                    "index": 3,
                    "header": {
                      "raw": "Total",
                      "normalized": "total"
                    },
                    "non_empty_cells": 120,
                    "mapping": {
                      "status": "mapped",
                      "field": "total_amount",
                      "score": 0.93,
                      "method": "classifier",
                      "candidates": [
                        {
                          "field": "total_amount",
                          "score": 0.93
                        },
                        {
                          "field": "currency",
                          "score": 0.2
                        },
                        {
                          "field": "invoice_number",
                          "score": 0.06
                        }
                      ]
                    }
                  },
                  {
                    "index": 4,
                    "header": {
                      "raw": "Notes",
                      "normalized": "notes"
                    },
                    "non_empty_cells": 44,
                    "mapping": {
                      "status": "passthrough",
                      "unmapped_reason": "passthrough_policy"
                    }
                  }
                ]
              }
            }
          ]
        }
      ]
    }
  ]
}
