# Copy to a private file (for example ./bootstrap_launch_infra.env) and fill values.
# Prerequisites:
#   - az (Azure CLI)
#   - psql (PostgreSQL client)
#   - curl
# Provisioning engine:
#   - scripts/azure/bicep/main.bicep (invoked by bootstrap_launch_infra.sh)
# Preflight:
#   command -v az curl psql
#   az bicep version
#   az login
#   az account set --subscription "<SUBSCRIPTION_ID>"
#   az account show --query "{name:name,id:id,tenantId:tenantId}" -o table
# Then run:
#   bash scripts/azure/bootstrap_launch_infra.sh --env-file ./bootstrap_launch_infra.env

# Core target
SUBSCRIPTION_ID=00000000-0000-0000-0000-000000000000
LOCATION=canadacentral

# Name generation controls (CAF style defaults)
NAME_STEM=automaticdataextractor
NAME_SUFFIX=
DEPLOY_DEV=true
# Set DEPLOY_DEV=false for prod-only provisioning.

# Generated defaults (override only when needed):
# RESOURCE_GROUP=rg-automaticdataextractor
# VNET_NAME=vnet-automaticdataextractor
# ACA_SUBNET_NAME=snet-automaticdataextractor-aca
# ACA_ENV_NAME=cae-automaticdataextractor-canadacentral
# LOG_ANALYTICS_WORKSPACE_NAME=log-automaticdataextractor
# POSTGRES_SERVER_NAME=psql-automaticdataextractor-canadacentral
# STORAGE_ACCOUNT_NAME=saautomaticdataextractor
# PROD_APP_NAME=ca-automaticdataextractor-prod
# DEV_APP_NAME=ca-automaticdataextractor-dev
# PROD_STORAGE_MOUNT_NAME=share-automaticdataextractor-prod
# DEV_STORAGE_MOUNT_NAME=share-automaticdataextractor-dev
# Example overrides if generated defaults collide:
# STORAGE_ACCOUNT_NAME=saautomaticdataextractor01
# POSTGRES_SERVER_NAME=psql-automaticdataextractor-canadacentral-01
# LOG_ANALYTICS_WORKSPACE_NAME=log-automaticdataextractor-01

# Network
VNET_CIDR=10.80.0.0/16
ACA_SUBNET_CIDR=10.80.0.0/23

# PostgreSQL Flexible Server
POSTGRES_ADMIN_USER=adeadmin
POSTGRES_ADMIN_PASSWORD=change-me
POSTGRES_PROD_DB=ade
POSTGRES_DEV_DB=ade_dev
POSTGRES_VERSION=18.1
POSTGRES_TIER=Burstable
POSTGRES_SKU_NAME=Standard_B1ms
POSTGRES_STORAGE_SIZE_GB=32

# Storage
STORAGE_SKU=Standard_LRS
BLOB_PROD_CONTAINER=ade-prod
BLOB_DEV_CONTAINER=ade-dev
FILE_PROD_SHARE=ade-data-prod
FILE_DEV_SHARE=ade-data-dev

# Apps
PROD_IMAGE=ghcr.io/clac-ca/automatic-data-extractor:vX.Y.Z
DEV_IMAGE=ghcr.io/clac-ca/automatic-data-extractor:vX.Y.Z
PROD_WEB_URL=https://ade.example.com
DEV_WEB_URL=https://ade-dev.example.com
PROD_SECRET_KEY=change-me-prod-secret-key-32-bytes-min
DEV_SECRET_KEY=change-me-dev-secret-key-32-bytes-min

# DB role names used in ADE_DATABASE_URL usernames.
# Defaults are PROD_APP_NAME / DEV_APP_NAME when unset.
PROD_DB_ROLE_NAME=
DEV_DB_ROLE_NAME=

# Runtime behavior
DATABASE_AUTH_MODE=managed_identity
ENABLE_FABRIC_AZURE_SERVICES_RULE=true
PROD_MIN_REPLICAS=1
PROD_MAX_REPLICAS=2
DEV_MIN_REPLICAS=0
DEV_MAX_REPLICAS=1
VERIFY_DEPLOYMENT=true
# Optional: override Bicep template path if needed.
# BICEP_TEMPLATE_FILE=scripts/azure/bicep/main.bicep

# Optional operator/CI public IPs (comma-separated IPv4 list).
# These IPs are added to PostgreSQL firewall rules and Storage firewall rules.
OPERATOR_IPS_CSV=203.0.113.10,198.51.100.20
