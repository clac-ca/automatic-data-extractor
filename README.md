# ADE — Automatic Data Extractor

Automatic Data Extractor (ADE) ingests semi-structured documents and turns them into tabular datasets. The project ships as a FastAPI backend with an in-process worker and optional React frontend. Operators interact with ADE exclusively through the HTTP API, which keeps automation, UI, and integrations aligned.

- **Deterministic jobs** – Extraction logic is revision-controlled so reruns produce identical outputs.
- **Workspace aware** – Every request is scoped to a workspace through URL paths like `/workspaces/{workspace_id}` for simple multi-tenancy.
- **Single API surface** – Upload documents, run jobs, inspect events, and fetch results through the same FastAPI application.

## Documentation

Guides now live under the [`docs/`](docs/README.md) directory:

- [User Guide](docs/user-guide/README.md) – core workflows for documents, jobs, results, and events.
- [Admin Guide](docs/admin-guide/README.md) – deployment, configuration, and operational building blocks.
- [Reference glossary](docs/reference/glossary.md) – shared terminology across API payloads and database entities.

## Quickstart (local)

### Get set up

1. Install prerequisites (skip any you already have):
   - [Python 3.11](https://www.python.org/downloads/) with `pip`
   - [Node.js 20 LTS](https://nodejs.org/en/download/) (includes `npm`)
   - [Git](https://git-scm.com/downloads)

   ```bash
   python --version
   node --version
   npm --version
   git --version
   ```

2. Clone ADE and install dependencies:

   ```bash
   git clone https://github.com/your-org/automatic-data-extractor.git
   cd automatic-data-extractor
   cp .env.example .env

   python -m venv .venv
   # macOS / Linux
   source .venv/bin/activate
   # Windows PowerShell
   # .\.venv\Scripts\Activate.ps1

   python -m pip install --upgrade pip
   pip install -e .[dev]
   ```

3. Start both servers with the CLI:

   ```bash
   ade start
   ```

   You’ll see a short banner with the backend and frontend URLs, followed by colour-coded logs from each process. Stop everything with `Ctrl+C`. Use `--skip-backend`, `--skip-frontend`, `--vite-api-base-url`, `--env KEY=VALUE`, or `--no-color` to tweak the run. The command automatically runs `npm install` before the first launch when required.

   Example: `ade start --env ADE_LOGGING_LEVEL=DEBUG --env ADE_API_DOCS_ENABLED=true --env ADE_JWT_ACCESS_TTL=15m`
   Adjust the backend bind address with `ADE_SERVER_HOST` / `ADE_SERVER_PORT` (for example `0.0.0.0:8000` inside a container). Use `ADE_SERVER_PUBLIC_URL` for the public origin that browsers or webhooks should hit. Time-based settings such as `ADE_JWT_ACCESS_TTL` accept either plain seconds (`900`) or suffixed strings like `15m`, `1h`, or `30d`. When you publish ADE behind TLS on a DNS name such as `https://ade.example.com`, set both `ADE_SERVER_PUBLIC_URL=https://ade.example.com` and `VITE_API_BASE_URL=https://ade.example.com`, then list the same domain in `ADE_SERVER_CORS_ORIGINS` (comma or whitespace separated) so the browser is allowed through.

> Prefer installing from PyPI? Run `python -m pip install automatic-data-extractor`, but still clone the repository before you call `ade start` so the frontend sources are available.

4. Inspect the active configuration:

   ```bash
   ade settings
   ```

   The command prints the resolved settings (post `.env` and environment overrides) with secrets masked. Pipe the JSON output into other tools when debugging deployments.

### Start each service manually (optional)

Some workflows keep the servers in separate terminals. Run `npm install` inside `frontend/` before starting the Vite dev server (repeat only after dependency changes):

```bash
# Terminal 1 – backend (from repo root)
uvicorn app.main:app --reload

# Terminal 2 – frontend
cd frontend
npm install  # first run only
npm run dev -- --host
```

The FastAPI application is created in [`app/main.py`](app/main.py). Configuration is loaded once at startup using the `Settings` model defined in [`app/core/settings.py`](app/core/settings.py) and cached on `app.state.settings`.

Open <http://localhost:8000/docs> to explore the autogenerated OpenAPI documentation. Docs are disabled by default; enable them with `ADE_API_DOCS_ENABLED=true`. The frontend expects the API on `http://localhost:8000` during development; adjust by setting `VITE_API_BASE_URL` if you proxy through a different port.

### Admin CLI quickstart

Once dependencies are installed the `ade` command becomes available for user and API key administration:

```bash
# Bootstrap an administrator account
ade users create --email admin@example.com --password "S3cureP@ss" --role admin

# Issue an API key for scripting or service integrations
ade api-keys issue --email admin@example.com --json

# Reset credentials later using the email address
ade users set-password --email admin@example.com --password "N3wPass!"
```

The CLI prints human-readable tables by default and can emit JSON with `--json` for scripting. See the [admin getting started guide](docs/admin-guide/getting_started.md) for a deeper walkthrough of typical tasks.

## Architecture snapshot

ADE follows a feature-first layout inside the `app/` package:

- [`app/auth`](app/auth) – password, SSO, and API key flows plus access-control helpers.
- [`app/documents`](app/documents) – multipart uploads, metadata, downloads, and deletions.
- [`app/jobs`](app/jobs) – submission, status tracking, and background execution via the in-process task queue.
- [`app/results`](app/results) – table retrieval by job or document identifier.
- [`app/workspaces`](app/workspaces) – routing helpers and dependencies that enforce workspace-scoped URLs.
- [`app/events`](app/events) – immutable audit trail with workspace scoping.
- [`app/configurations`](app/configurations) – feature flags and per-workspace configuration records.
- [`app/users`](app/users) – identity management, roles, and repositories shared across features.

Shared infrastructure lives under [`app/core`](app/core) (logging, middleware, settings, database helpers) and [`app/models`](app/models) (SQLAlchemy metadata, mixins, and entity models). React build artefacts are served from [`app/static`](app/static) by FastAPI.

Uploaded files and the SQLite database are stored beneath the [`var/`](var) directory by default. Override locations with the `ADE_STORAGE_DATA_DIR`, `ADE_DATABASE_DSN`, or `ADE_STORAGE_DOCUMENTS_DIR` environment variables when deploying to production systems.

> **TODO**
> Publish the official Docker image to GitHub Container Registry and update the admin guide once the frontend onboarding flow ships.

## Status

The backend is under active development. The high-level concepts above are stable; deeper guide content is being authored iteratively so it can track ongoing feature work without churn.

